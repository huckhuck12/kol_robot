## 实现KOL交易信号推送系统

### 项目概述
创建一个Node.js应用，模拟浏览器访问KOL平台API，抓取最新交易信号，并推送到钉钉机器人。

### 技术栈
- **Node.js**：运行环境
- **axios**：HTTP请求库（模拟浏览器访问）
- **cheerio**：HTML解析（如需解析动态内容）
- **node-schedule**：定时任务
- **dingtalk-robot-sdk**：钉钉机器人SDK
- **fs**：本地文件存储（记录已处理信号）

### 实现步骤

#### 1. 项目初始化
- 创建`package.json`文件
- 安装必要依赖：`axios`、`node-schedule`、`dingtalk-robot-sdk`

#### 2. 配置文件
- 创建`config.js`：
  - API配置（URL、请求参数）
  - 钉钉机器人配置（webhook、密钥）
  - 定时任务配置（检查频率）
  - 本地存储配置（文件路径）

#### 3. 核心功能模块

##### 3.1 API访问模块
- 实现`api.js`：
  - 模拟浏览器请求头
  - 发送GET请求获取API数据
  - 解析JSON响应

##### 3.2 数据处理模块
- 实现`dataProcessor.js`：
  - 提取结构化交易信号
  - 过滤有效信号（包含交易信息）
  - 与本地存储对比，筛选新信号

##### 3.3 钉钉推送模块
- 实现`dingTalk.js`：
  - 初始化钉钉机器人客户端
  - 格式化消息内容
  - 发送推送请求

##### 3.4 本地存储模块
- 实现`storage.js`：
  - 读取已处理信号ID
  - 写入新处理信号ID
  - 定期清理旧数据

##### 3.5 定时任务模块
- 实现`schedule.js`：
  - 设置定时任务（如每5分钟检查一次）
  - 调用各模块完成完整流程

##### 3.6 主程序入口
- 实现`index.js`：
  - 初始化各模块
  - 启动定时任务
  - 处理异常情况

#### 4. 消息格式设计
- **钉钉消息格式**：使用Markdown格式
- **包含信息**：
  - KOL名称
  - 交易对
  - 交易方向（多/空）
  - 入场价格
  - 止损价格
  - 目标价格
  - 杠杆建议
  - 分析理由
  - 信号时间

#### 5. 异常处理
- API请求失败重试机制
- 钉钉推送失败处理
- 数据解析错误处理
- 日志记录

#### 6. 测试与部署
- 本地测试各模块功能
- 部署到服务器运行
- 监控运行状态

### 项目文件结构
```
kol_robot/
├── config.js              # 配置文件
├── package.json           # 项目依赖
├── src/
│   ├── api.js            # API访问模块
│   ├── dataProcessor.js  # 数据处理模块
│   ├── dingTalk.js       # 钉钉推送模块
│   ├── storage.js        # 本地存储模块
│   ├── schedule.js       # 定时任务模块
│   └── index.js          # 主程序入口
└── data/
    └── processedSignals.json  # 已处理信号记录
```

### 关键实现细节
1. **模拟浏览器**：设置合理的User-Agent和请求头，避免被API识别为爬虫
2. **去重机制**：使用信号ID作为唯一标识，确保每个信号只推送一次
3. **定时频率**：根据API速率限制（每60秒5次）设置合理的检查间隔
4. **消息格式**：优化钉钉消息排版，确保信息清晰易读
5. **错误处理**：完善的异常捕获和重试机制，确保系统稳定运行